<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Vol</title>
  <meta name="description" content="Vol">
  <meta name="author" content="Vol">

  <link rel="stylesheet" href="styles.css">

</head>

<body>
    <input id = "lat" type = "number">
    <input id = "long" type = "number">
    <button id="create">create user</button>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/6.6.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="rsvp.min.js"></script>
    <script src="https://cdn.firebase.com/js/client/1.0.17/firebase.js"></script>

<script src="https://www.gstatic.com/firebasejs/6.6.1/firebase-auth.js"></script>
<script src="https://cdn.firebase.com/libs/geofire/2.0.0/geofire.min.js">
    
  </script>
<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAJeOk00rKxqC7vqH12T-OysJ88Y000ZaA",
    authDomain: "volauthtest.firebaseapp.com",
    databaseURL: "https://volauthtest.firebaseio.com",
    projectId: "volauthtest",
    storageBucket: "",
    messagingSenderId: "817461452456",
    appId: "1:817461452456:web:159163e0d1cd3ef3bf6c9d"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
</script>
    
    <script>
    var firebaseRef = new Firebase("https://volauthtest.firebaseio.com/geofire/");
    var geoFire = new GeoFire(firebaseRef);
    var loc;
    navigator.geolocation.getCurrentPosition(
        function (response) {
            loc = response;
        }
    )
</script>

<script>
    const createButton = document.querySelector('#create');
    createButton.addEventListener('click', function() {
        
        console.log(loc.coords.latitude)
        
        //Set the place to search
        const lat = Number(document.querySelector('#lat').value);
        const long = Number(document.querySelector('#long').value);
           geoFire.set("test", [lat, long]).then(
               function() {
               console.log("Provided key has been added to GeoFire");
                }, function(error) {
               console.log("Error: " + error);
        });
        
        //Do a query
         var geoQuery = geoFire.query({
               center: [loc.coords.latitude, loc.coords.longitude],
               radius: 25 //kilometers
         });
         geoQuery.on("key_entered", function(key, location, distance) {
             console.log("There is a charity event " + key + " found at " + location + " (" + distance + " km away)");
         });
        var onReadyRegistration = geoQuery.on("ready", function() {
         console.log("GeoQuery has loaded and fired all other events for initial data");
        });
      });
</script>    
    
</body>
    
</html>